# GToken 社区启动合约操作手册

本文档旨在从社区运营和技术贡献的视角，解释 GToken 社区启动合约的工作原理，并为社区负责人和技术团队提供清晰的操作指引。

---

## 重要声明与免责条款

**请所有参与者在参与前仔细阅读并理解以下条款：**

1.  **非投资性质**: GToken 是用于参与 Mycelium 协议生态、使用网络功能并参与治理的功能性凭证（Utility Token）。它**不是**一种投资产品，不代表任何股权、债权或利润分配权。我们**不承诺**任何形式的财务回报或价值增值。参与社区启动是基于对协议理念的认同和贡献的意愿，而非投资行为。

2.  **基础权益**: 持有 GToken 的核心权益是作为协议成员的**参与权**和未来的**治理投票权**。您将能够使用协议的各项功能，并对社区的未来发展方向发表意见。

3.  **开源与社区治理**: Mycelium 协议及其所有智能合约代码均开源，以实现完全透明。包括建立二级市场流动性池（如 Uniswap V4 Pool）在内的所有重大决策，都将在社区认为合适的时候，通过未来的 DAO 治理流程来决定。

4.  **风险提示**: 您将与一个部署在区块链上的、实验性的、自主运行的智能合约进行交互。所有交互均由您本人发起，您需对自己的行为负责。本软件按“原样”提供，不作任何明示或暗示的保证。

---

## 核心概念：两阶段流动性规划

在深入了解本合约前，必须理解我们的 GToken 发行包含两个重要阶段和两种不同的“池”：

1.  **第一阶段：社区启动合约 (本合约)**
    *   **别名**: “初始兑换平台”。
    *   **目的**: 面向白名单内的早期贡献者，开启**一次性的、限量的社区初始启动期**，以获取协议启动所需的基础资源。
    *   **特点**: 兑换率随参与进程自动提升，额满即止。这是一个封闭的、有准入许可的参与过程。

2.  **第二阶段：Uniswap V4 流动池 (未来建立)**
    *   **别名**: “社区长期流动池”。
    *   **目的**: 在社区初始启动**成功后**，利用部分资源和 GToken 建立一个永久性的、公开的流动性池。
    *   **特点**: 为整个社区提供持续的、双向的 GToken 兑换场所。未来新成员需要持有 GToken 以参与协议（如运行节点、注册社区等）时，将从这个池中进行兑换。

**本文档聚焦于第一阶段的社区启动合约。**

---

## 一、面向社区负责人 (Staff) 的产品说明

### 1. 合约逻辑 (启动合约如何工作)

1.  **只提供一种凭证**: 合约内只提供 GToken 的兑换。
2.  **限量供应**: 我们会提前向合约内“授权”固定的 105 万枚 GToken。合约本身无法增发，兑换完毕即结束。
3.  **动态兑换率 (斜率驱动)**: 兑换率从一个基于 **$1.0** 的初始比率开始，然后根据预设的“增长速度”随着参与的进程而自动提升。
    *   **第一阶段**: 每有 10,000 枚 GToken 被兑换，兑换率提升 $0.025。
    *   **第二阶段**: 每有 10,000 枚 GToken 被兑换，兑换率提升 $0.050。
    *   **第三阶段**: 每有 10,000 枚 GToken 被兑换，兑换率提升 $0.030。
    *   这种机制下，最终结束时的兑换率是一个自然产生的结果，大约会在 **$4.885** 左右。
4.  **贡献者优先 (白名单机制)**: 这不是一个对所有人开放的平台。它有一个“智能守卫”（链下验证服务）。只有在您提供的“早期贡献者名单”上的人，才能获得“数字凭证”（一个特殊的签名），“守卫”验证凭证后才允许参与兑换。
5.  **严格的参与规则**: “守卫”还会执行两个规则：
    *   **每人仅限参与一次**。
    *   **遵守个人额度**（例如，某地址最多只能兑换价值 $3000 的份额）。
6.  **支持多种资产**: 参与者可以使用 USDC, USDT, ETH, WBTC 等主流数字资产进行兑换。
7.  **资源自动入库**: 所有用于兑换的资产都会被直接、安全地转入 DAO 的“金库”（Treasury 多签钱包），全程在区块链上公开透明。

### 2. 您需要准备什么？

您的工作主要在“链下”，即合约部署前的准备和部署后的运营。

**准备阶段 (Checklist):**

1.  **✅ 确定“早期贡献者名单” (白名单)**: 最重要的准备工作。整理一份表格，包含：
    *   `参与者的以太坊地址`
    *   `该地址对应的最高兑换额度 (以美元计)`
2.  **✅ 确定“金库”地址 (Treasury)**: 提供一个最终接收资产的、绝对安全的多签钱包地址。
3.  **✅ 确定“管理员”地址 (Owner)**: 提供一个用于管理合约的、绝对安全的多签钱包地址。
4.  **✅ 准备社区沟通材料**: 撰写清晰的公告、教程、FAQ，向社区解释活动规则和参与步骤。

### 3. 如何使用/监控合约？

*   **您的角色**: 社区沟通和用户支持。合约一旦启动，兑换过程是全自动的。
*   **如何监控**: 您可以通过区块链浏览器（如 Etherscan）实时监控活动进展。技术人员会提供给您一个专属的合约地址链接。通过链接，您可以看到：
    *   当前已被兑换的 GToken 数量 (`tokensSold`)。
    *   当前的实时兑换率 (`getCurrentPriceUSD`)。
    *   每一笔成功的兑换记录。
*   **问题支持**: 当社区成员遇到问题时（例如“为什么我无法参与？”），您需要充当第一响应人。您可以先根据白名单核对他的资格，如果信息无误，再将问题同步给技术人员排查。

---

## 二、面向技术团队 (Dev) 的操作手册

### 第一阶段：预部署

1.  **完成合约代码**:
    *   在 `buyTokens` 函数中，完成 `TODO` 标记的 **EIP-712 签名验证**逻辑。
    *   在 `buyTokens` 函数中，完成 `TODO` 标记的**多资产兑换**逻辑，需集成 Chainlink 预言机来换算 ETH/WBTC 的美元价值。
2.  **部署链下验证服务**:
    *   根据产品提供的白名单（地址-额度），部署一个可以为合格用户请求签发 EIP-712 签名的后端服务。
3.  **最终测试网演练**:
    *   将**合约**和**验证服务**完整部署到 Sepolia 等公开测试网。
    *   邀请核心社区成员，使用测试资产进行一次端到端的完整兑换流程演练。

### 第二阶段：主网部署日

1.  **获取最终地址**: 从核心团队获取最终的、用于主网的**金库 (Treasury) 地址**和**管理员 (Owner) 地址**。
2.  **部署合约**:
    *   运行 `forge script script/DeploySaleContract.s.sol --rpc-url [主网RPC] --broadcast --verify` 命令部署合约。
3.  **配置合约**:
    *   部署成功后，立即由 **Owner** 地址调用 `setWhitelistVerifier()` 函数，将合约与链下验证服务的签名地址关联起来。
4.  **为合约“授权额度” (关键步骤!)**:
    *   从 DAO 的代币持有地址，向新部署的 `SaleContract` 合约地址**转入 1,050,000 枚 GToken**。**此步骤完成前，任何兑换都无法进行。**
5.  **公开合约**:
    *   在 Etherscan 上确认合约已开源验证。将合约地址分享给社区和运营团队用于监控。

### 第三阶段：社区启动结束后

1.  **回收剩余 GToken**: 如果活动期结束但仍有 GToken 剩余，由 **Owner** 地址调用 `withdrawUnsoldTokens()` 函数，将剩余 GToken 转回金库。
2.  **建立 Uniswap V4 长期流动性池**: 这是为社区提供长期流动性的关键步骤。使用初始启动期获得的部分资源和对应比例的 GToken，在 Uniswap V4 上建立一个永久性的流动性池。**未来新成员需要持有 GToken 参与协议时（如运行节点、注册社区等），将从这个池中进行兑换。**
